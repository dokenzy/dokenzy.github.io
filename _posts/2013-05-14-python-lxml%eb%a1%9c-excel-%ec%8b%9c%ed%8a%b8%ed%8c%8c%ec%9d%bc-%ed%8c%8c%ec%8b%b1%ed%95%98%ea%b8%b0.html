---
layout: post
title: 'Python:: lxml로 excel 시트파일 파싱하기'
post_id: '465'
date: 2013-05-14 18:34:13.000000000 +09:00
type: post
published: true
status: publish
categories:
- Python
tags:
- excel
- lxml
- namespaces
- Python
- XML
- 네임스페이스
meta:
  _edit_last: '1'
author:
  login: dokenzy
  email: dokenzy@gmail.com
  display_name: dokenzy
  first_name: ''
  last_name: ''
---
<pre class="lang:python decode:true"># -*- coding: utf-8 -*-
from lxml import etree

xml = etree.parse('excel/xl/worksheets/sheet1.xml')
ns = u'http://schemas.openxmlformats.org/spreadsheetml/2006/main'
c = xml.find("//ns:c[@r='B13']", namespaces={'ns': ns})</pre>
<p>네임스페이스가 있는 xml 문서의 경우, 노드를 찾을 때 네임스페이스를 명시하지 않으면 노드를 찾을 수 없다.</p>
<p>xml.xpath()로 찾을 수도 있지만, xpath로 찾으면 결과를 리스트로 반환해 준다. 찾을 노드가 1개인 것이 확실하면 find()를 이용하는 것이 편하다. find()는 조건에 해당하는 첫 번째 노드만 반환하기 때문이다.</p>
<p>기본 네임스페이스를 지정해서 매번 namespaces를 적어주지 않으면 편할텐데, 그런 방법은 제공하지 않는다고 한다.</p>
<p>관련문서: <a href="http://lxml.de/FAQ.html" target="_blank">http://lxml.de/FAQ.html</a></p>
