---
layout: post
title: 'Python:: lxml.etree에서 네임스페이스가 있는 속성값 가져오기'
post_id: '960'
date: 2014-02-25 17:02:03.000000000 +09:00
type: post
published: true
status: publish
categories:
- Python
tags:
- excel
- lxml
- namespaces
- nsmap
- Python
- XML
meta:
  _edit_last: '1'
author:
  login: dokenzy
  email: dokenzy@gmail.com
  display_name: dokenzy
  first_name: ''
  last_name: ''
---
<p>lxml.etree로 노드를 찾거나 값을 변경하고 싶을 때에는 항상 네임스페이스를 고려해야 한다.</p>
<p>특정 노드에서 네임스페이스가 있는 속성값을 구하고자 할 때는 다음과 같이 한다. get(self, key, default=None) 메소드를 사용한다. 여기서 key가 바로 찾고자 하는 속성 이름이다. 그런데 네임스페이스가 있는 속성을 찾아야 하는데, 노드를 추가하거나 찾을 때 처럼 nsmap이나 namespaces 등의 속성을 사용할 수 없다. 이런 경우에는 다음과 같이 한다.</p>
<pre class="lang:python decode:true">NS_WORKSHEET_R      = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships'
rId = el.get('{%s}id' % NS_WORKSHEET_R)</pre>
<p>현재 노드인 'el'에는 r:id라는 속성이 있다(el.keys() 또는 el.attrib로 알 수 있다).</p>
<p>이 때 'r'이 네임스페이스다. 이 XML문서의 루트노드에는 이 r이 'http://schemas.openxmlformats.org/officeDocument/2006/relationships'라고 되어있다.</p>
<p>따라서 위와 같이 네임스페이스까지 포함하여 문자열로 만들어서 사용하면 된다.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
