---
layout: post
title: Excel파일을 XML로 다루기(시트 추가하기)
post_id: '451'
date: 2013-05-05 19:45:47.000000000 +09:00
type: post
published: true
status: publish
categories:
- Python
tags:
- excel
- xlsxl
- XML
meta:
  _edit_last: '1'
author:
  login: dokenzy
  email: dokenzy@gmail.com
  display_name: dokenzy
  first_name: ''
  last_name: ''
---
<p>excel 2007 파일을 다루는 파이썬 라이브러러리를 만들고 있다.</p>
<p>새 시트 만드는 기능을 추가했다. 나중을 위해 간단히 요약해 둔다.</p>
<ol>
<li>엑셀 파일(foo.xlsx)의 확장자를 zip으로 변경한다(foo.zip)</li>
<li>새 폴더를 만들고 그 안에 zip파일의 압축을 푼다.</li>
<li>[Content_Types].xml 파일 하나와 3개의 폴더(docProps, xl, _rels)가 나타난다. 물론 각 폴더마다 하위 폴더 또는 파일이 있다.</li>
</ol>
<p>수정할 파일들은 다음과 같다.</p>
<ol>
<li><span style="line-height: 16px;">[Content_Typs].xml</span></li>
<li>docProps/app.xml</li>
<li>xl/workbook.xml</li>
<li>xl/_rels/workbook.xml.rels</li>
</ol>
<p>그리고 새 시트 파일을 추가해야 한다. 새 시트를 만드는 최소의 XML 태그는 다음과 같다.</p>
<pre class="lang:xhtml decode:true">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" mc:Ignorable="x14ac"&gt;
  &lt;sheetViews&gt;
    &lt;sheetView tabSelected="1" workbookViewId="0"&gt;
    &lt;/sheetView&gt;
  &lt;/sheetViews&gt;
  &lt;sheetFormatPr baseColWidth="10" defaultColWidth="8.83203125" defaultRowHeight="14" x14ac:dyDescent="0"/&gt;
  &lt;sheetData&gt;
  &lt;/sheetData&gt;
&lt;/worksheet&gt;</pre>
<p>새로 만든  새 시트용 XML파일을 xl/worksheets 폴더에 저장한다.</p>
<p>&nbsp;</p>
